{"version":3,"file":"index.js","names":["AhaOAuthClient","constructor","client_id","client_secret","subdomain","options","axiosInstance","useSubdomain","timeout","requestDefaultHeaders","baseUrl","_axios","axios","create","_token","undefined","token","arguments","length","tokenChanged","authorizeUri","redirectUri","responseType","state","brandId","display","prompt","authUrl","console","log","request","config","uri","hostname","path","url","toString","post","data","method","authorize","code","querystring","stringify","grant_type","redirect_uri","r","access_token"],"sources":["../src/index.js"],"sourcesContent":["import axios from 'axios'\nimport querystring from 'querystring'\nimport URI from 'urijs'\n\nclass AhaOAuthClient {\n    constructor(client_id, client_secret, subdomain, options, axiosInstance) {\n\tthis.client_id = client_id\n\tthis.client_secret = client_secret\n\tthis.options = options || { useSubdomain: true, timeout: null }\n\tthis.subdomain = subdomain\n\tthis.requestDefaultHeaders = {}\n\tif (this.options.useSubdomain === false) {\n            this.requestDefaultHeaders['X-AHA-ACCOUNT'] = this.subdomain;\n            this.subdomain = 'secure';\n\t}\n\tthis.baseUrl = `https://${this.subdomain}.aha.io`\n\tthis._axios = axiosInstance || axios.create()\n\tthis._token = undefined\n    }\n\n    token (_token) {\n\tif (arguments.length === 0) { // get\n\t    return this._token\n\t}\n\tconst tokenChanged = this._token !== _token\n\tthis._token = _token\n    }\n\n    authorizeUri (redirectUri, options = { responseType: 'code', state: '', brandId: '', display: '', prompt: '' }) {\n\tlet authUrl = this.baseUrl + \"/oauth/authorize\" +\n\t    \"?response_type=\" + options.responseType + \n\t    \"&client_id=\"   + this.client_id + \n            \"&redirect_uri=\" + redirectUri + \n            \"&state=\" + options.state\n\tconsole.log(\"Auth URL is: \" + authUrl)\n\treturn authUrl\n    }\n\n    request (config) {\n\tlet uri = URI(this.baseUrl)\n\tif (uri.hostname() === '') {\n\t    uri = URI(this.baseUrl).path(config.url)\n\t}\n\treturn this._axios.request({\n\t    ...config,\n\t    url: uri.toString()\n\t})\n    }\n\n    post (url, data = undefined, config = {}) {\n\treturn this.request({ ...config, method: 'post', url, data })\n    }\n\n    async authorize({ code, redirectUri }, options = {}) {\n\tlet data = querystring.stringify({\n\t    code: code,\n\t    client_id: this.client_id,\n\t    client_secret: this.client_secret,\n\t    grant_type: 'authorization_code',\n\t    redirect_uri: redirectUri,\n\t    ...options })\n\tconst r = await this._axios.request({\n\t    method: 'post',\n\t    url: URI(this.baseUrl).path('/oauth/token').toString(),\n\t    data,\n\t})\n\tthis.token(r.data.access_token)\n    }\n    \n}\n\nexport default AhaOAuthClient\n"],"mappings":"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"}